<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>플러스파인더 </title>
    <!-- 부트스트랩 cdn-->
    <link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- 부트스트랩 cdn  -->

    <style>
        html,
        body {
            height: 300px;
            width: 600px;
            margin: 10px;
        }

        .plusFinderTop {
            display: flex;
            flex-direction: row;
            gap: 20px;
        }

        .lblTitle {
            font-weight: bolder;
        }

        a:link {
            color: black;
            text-decoration: none;
        }

        a:visited {
            color: black;
            text-decoration: none;
        }

        a:hover {
            color: black;
            text-decoration: underline;
        }

        a:active {
            color: black;
            text-decoration: none;
        }
    </style>

</head>

<body>
<div class="plusFinderTop">
    <div class="searchForm">
        <div class="row g-3 align-items-center">
            <div class="col-auto">
                <label for="inputCode" class="col-form-label">
                    <p class="lblTitle">코드</p>
                </label>
            </div>
            <div class="col-auto">
                <input type="hidden" id="inputIDform">
                <input type="text" id="inputCode" class="form-control">
            </div>
        </div>

        <div class="row g-3 align-items-center">
            <div class="col-auto">
                <label for="inputName" class="col-form-label">
                    <p class="lblTitle">명칭</p>
                </label>
            </div>
            <div class="col-auto">
                <input type="hidden" id="inputNameform">
                <input type="text" id="inputName" class="form-control">
            </div>
        </div>
    </div>

    <div class="btnPf">
        <button type="button" class="btn btn-outline-primary" id="btnSearch">검색</button>
        <button type="button" class="btn btn-outline-primary" id="btnCheck">선택</button>
        <button type="button" class="btn btn-outline-primary" id="btnCancle">취소</button>
    </div>
</div>

<div class="plusFinderBottom">
    <div class="tbpf">
        <table class="table table-striped table-hover">
            <tr>
                <th th:each="colName : ${lstColName}" th:text="${colName}"></th>
            </tr>
            <tr th:each="rowData : ${lstpf}">
                <th:block th:each="row : ${rowData}">
                    <td><a href="#" th:text="${row.value}" th:value="${rowData['코드']}"
                           th:onclick="sendParent([[${rowData['코드']}]],[[${row.value}]])"></a>
                    </td>
                </th:block>
            </tr>
        </table>
    </div>

</div>

<!-- 스크립트 -->
<script th:inline="javascript">

    function Search() {
        let param = window.location.search;
        let param_url = new URLSearchParams(param);
        let sMiddle = document.querySelector("#inputName").value;
        let newUrl = window.location.pathname + '?' + param_url.toString();
        window.location.href = newUrl;

        console.log(newUrl);
    }

    document.querySelector("#btnSearch").addEventListener("click", Search);

    function sendParent(id, name) {
        let inputNameform = document.querySelector("#inputNameform").value;
        let inputIDform = document.querySelector("#inputIDform").value;

        console.log('inputNameform= ' + inputNameform);
        console.log('inputNameform= ' + inputNameform);
        console.log('id= ' + id);
        console.log('name= ' + name);

        opener.document.querySelector("#" + inputNameform).value = name;
        opener.document.querySelector("#" + inputNameform).setAttribute("data-id", id);
        opener.document.querySelector("#" + inputNameform).setAttribute("data-name", name);

        // if(inputIDform != ''){
        //     opener.document.querySelector("#" + inputIDform).value = id;
        //     opener.document.querySelector("#" + inputIDform).setAttribute("data-id", id);
        //     opener.document.querySelector("#" + inputIDform).setAttribute("data-name", name);
        // }

        this.close();

    }



</script>


</body>

</html>